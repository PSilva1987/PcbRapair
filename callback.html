<!DOCTYPE html>
<html>
<head>
    <title>Spotify Callback</title>
    <script>
        function sendTokenToParent() {
            if (window.location.hash) {
                const hashParams = new URLSearchParams(window.location.hash.substring(1));
                const tokenData = {
                    type: 'spotify-auth-response',
                    access_token: hashParams.get('access_token'),
                    expires_in: hashParams.get('expires_in'),
                    token_type: hashParams.get('token_type'),
                    state: hashParams.get('state')
                };
                
                // Envia para a janela principal
                if (window.opener) {
                    window.opener.postMessage(tokenData, "https://psilva1987.github.io");
                    window.close();
                } else {
                    document.body.innerHTML = '<h2>Autenticação concluída</h2><p>Você pode fechar esta janela.</p>';
                }
            } else {
                document.body.innerHTML = '<h2>Erro: Nenhum token recebido</h2>';
            }
        }
    </script>
</head>
<body onload="sendTokenToParent()">
    <p>Processando autenticação...</p>
</body>
</html>
